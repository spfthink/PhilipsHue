<!DOCTYPE html>
<html>
    <head>
        <script type="text/javascript" src="matlab.js"></script>
        <meta charset="UTF-8">

        <style>
        html, body {
        margin: 0;
        padding: 0;
        background: transparent;
        overflow: hidden;
        width: 100%;
        height: 100%;
        display: flex;
        justify-content: center;
        align-items: center;
        }

        /* NEW: wrapper div that contains the image */
        #wrapper {
        width: 100%;
        height: 100%;
        overflow: hidden; /* critical: prevents scaled image from overflowing */
        display: flex;
        justify-content: center;
        align-items: center;
        }

        /* Image stays static â€” no scaling applied directly */
        #pulseImg {
        width: 100%;
        height: 100%;
        object-fit: contain;
        }

        /* Animation now applies to the wrapper, not the image */
        .pulse-on {
        animation: subtlePulse 2.4s ease-in-out infinite;
        }

        @keyframes subtlePulse {
        0% {
        transform: scale(1);
        filter: drop-shadow(0 0 0 rgba(0, 150, 255, 0));
        }
        50% {
        transform: scale(1.5); /* safe now because wrapper hides overflow */
        filter: drop-shadow(0 0 6px rgba(0, 150, 255, 0.35));
        }
        100% {
        transform: scale(1);
        filter: drop-shadow(0 0 0 rgba(0, 150, 255, 0));
        }
        }
        </style>
    </head>

    <body>
        <!-- NEW: wrapper around the image -->
        <div id="wrapper">
            <img id="pulseImg" src="" />
        </div>

        <script>

        let wrapperEl;
        let imgEl;

        function setup(htmlComponent) {

        wrapperEl = document.getElementById('wrapper');
        imgEl = document.getElementById('pulseImg');

        applyState(htmlComponent.Data);

        htmlComponent.on('DataChanged', function () {
        applyState(htmlComponent.Data);
        });
        }

        function applyState(data) {
        if (!wrapperEl || !imgEl || !data) return;

        if (data.src) {
        imgEl.src = data.src;
        }

        if (data.on) {
        wrapperEl.classList.add('pulse-on');
        } else {
        wrapperEl.classList.remove('pulse-on');
        }

        if (data.speed) {
        wrapperEl.style.animationDuration = data.speed + 's';
        }
        }
        </script>
    </body>
</html>
